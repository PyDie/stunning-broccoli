# –ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –æ—á–∏—Å—Ç–∫–∞ –∫–æ–¥–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

## üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1. Debug —Ä–µ–∂–∏–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–ö–†–ò–¢–ò–ß–ù–û)
**–§–∞–π–ª:** `app/dependencies.py`
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–∞—Ä–∞–º–µ—Ç—Ä `x_debug_user_id` –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–æ–π—Ç–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é Telegram
```python
x_debug_user_id: int | None = Header(default=None),
if x_debug_user_id:
    # –°–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ Telegram –ø–æ–¥–ø–∏—Å–∏!
```

**–†–µ—à–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –∏–ª–∏ –∑–∞—â–∏—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 2. –û—Ç–∫—Ä—ã—Ç—ã–π endpoint –º–∏–≥—Ä–∞—Ü–∏–π (–ö–†–ò–¢–ò–ß–ù–û)
**–§–∞–π–ª:** `app/main.py`
**–ü—Ä–æ–±–ª–µ–º–∞:** Endpoint `/migrate` –¥–æ—Å—Ç—É–ø–µ–Ω –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
```python
@app.post("/migrate")
async def migrate_db():
    # –õ—é–±–æ–π –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏!
```

**–†–µ—à–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –∏–ª–∏ –∑–∞—â–∏—Ç–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π + –ø—Ä–æ–≤–µ—Ä–∫–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 3. –¢–µ—Å—Ç–æ–≤—ã–π endpoint —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
**–§–∞–π–ª:** `app/routers/users.py`
**–ü—Ä–æ–±–ª–µ–º–∞:** Endpoint `/me/notifications/test` –Ω–µ –Ω—É–∂–µ–Ω –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
```python
@router.post("/me/notifications/test")
```

**–†–µ—à–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –∏–ª–∏ –∑–∞—â–∏—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 4. CORS —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –≤—Å–µ origins
**–§–∞–π–ª:** `app/main.py`
**–ü—Ä–æ–±–ª–µ–º–∞:** `allow_origins=["*"]` —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã —Å –ª—é–±—ã—Ö –¥–æ–º–µ–Ω–æ–≤
```python
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],  # –û–ü–ê–°–ù–û!
```

**–†–µ—à–µ–Ω–∏–µ:** –£–∫–∞–∑–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–æ–º–µ–Ω—ã

### 5. Debug –∫–æ–¥ –≤ frontend
**–§–∞–π–ª:** `webapp/app.js`
**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `debugUserId` –∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `X-Debug-User-Id`
```javascript
if (state.debugUserId) {
    headers["X-Debug-User-Id"] = state.debugUserId;
}
```

**–†–µ—à–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –∏–ª–∏ –∑–∞—â–∏—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 6. –†–∞—Å–∫—Ä—ã—Ç–∏–µ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –æ—à–∏–±–æ–∫
**–§–∞–π–ª:** `app/routers/families.py:136`
**–ü—Ä–æ–±–ª–µ–º–∞:** –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏
```python
raise HTTPException(status_code=500, detail=f"Internal Server Error: {str(e)}")
```

**–†–µ—à–µ–Ω–∏–µ:** –ù–µ —Ä–∞—Å–∫—Ä—ã–≤–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–æ–∫ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

## ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### 7. –•–∞—Ä–¥–∫–æ–¥ –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ë–î
**–§–∞–π–ª:** `app/config.py:15`
**–ü—Ä–æ–±–ª–µ–º–∞:** –î–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–∞—Ä–æ–ª—å
```python
database_url: str = "postgresql://postgres:postgres@localhost:5432/tgcalendar_db"
```

**–†–µ—à–µ–Ω–∏–µ:** –£–±—Ä–∞—Ç—å –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ

### 8. –§–ª–∞–≥ –ø—Ä–æ–ø—É—Å–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏
**–§–∞–π–ª:** `app/config.py:18`
**–ü—Ä–æ–±–ª–µ–º–∞:** `tg_skip_signature_check` –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
```python
tg_skip_signature_check: bool = False
```

**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –≤—Å–µ–≥–¥–∞ `False`

## üìù –ù–µ–Ω—É–∂–Ω—ã–π –∫–æ–¥ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### 9. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
- `app/routers/families.py:135` - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø—Ä–æ debugging
- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ —Å –ø–æ–º–µ—Ç–∫–∞–º–∏ `# üëà`, `# <--` –∏ —Ç.–¥.

### 10. –î—É–±–ª–∏—Ä—É—é—â–∏–π endpoint `/me`
**–§–∞–π–ª:** `app/main.py:88`
**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å—Ç—å –∏ –≤ `app/routers/users.py` –∏ –≤ `app/main.py`

## ‚úÖ –ß—Ç–æ —Ö–æ—Ä–æ—à–æ

- SQL –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç ORM (SQLAlchemy) - –∑–∞—â–∏—Ç–∞ –æ—Ç SQL –∏–Ω—ä–µ–∫—Ü–∏–π ‚úÖ
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Pydantic ‚úÖ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ ‚úÖ
- JWT —Ç–æ–∫–µ–Ω—ã —Å –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è ‚úÖ
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ Telegram WebApp ‚úÖ

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `ENVIRONMENT=production|development`
2. ‚úÖ Debug —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ development
3. ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å —É—á–µ—Ç–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏—è
4. ‚úÖ –¢–µ—Å—Ç–æ–≤—ã–µ endpoints –∑–∞—â–∏—â–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
5. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (–Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞—é—Ç—Å—è –¥–µ—Ç–∞–ª–∏ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ)
6. ‚úÖ –£–¥–∞–ª–µ–Ω –¥—É–±–ª–∏—Ä—É—é—â–∏–π endpoint `/me`
7. ‚úÖ –£–±—Ä–∞–Ω—ã —Ö–∞—Ä–¥–∫–æ–¥ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ë–î

### –û—Å—Ç–∞–ª–æ—Å—å —Å–¥–µ–ª–∞—Ç—å:
- [ ] –î–æ–±–∞–≤–∏—Ç—å rate limiting –¥–ª—è API
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç–∏–Ω–≥
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å HTTPS –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —É—Ä–æ–≤–Ω–µ API gateway

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

–í `.env` —Ñ–∞–π–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
```env
ENVIRONMENT=production
CORS_ORIGINS=https://your-domain.com,https://www.your-domain.com
DATABASE_URL=postgresql://user:password@host:5432/dbname
JWT_SECRET=your-secret-key-here
BOT_TOKEN=your-bot-token
WEBAPP_URL=https://your-domain.com/miniapp
TG_SKIP_SIGNATURE_CHECK=false
```
